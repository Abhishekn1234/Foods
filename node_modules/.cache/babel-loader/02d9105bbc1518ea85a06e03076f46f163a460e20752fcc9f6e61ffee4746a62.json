{"ast":null,"code":"// Cart.js\nimport React,{useEffect,useState}from'react';import{Table,Button}from'react-bootstrap';import axios from'axios';import{useCart,useDispatchCart}from'./Contextreducer';import{useNavigate,Link}from'react-router-dom';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";export default function Cart(){const cart=useCart();const dispatch=useDispatchCart();const[totalPrice,setTotalPrice]=useState(0);const userEmail=localStorage.getItem('userEmail');const Name=localStorage.getItem('Name');const navigate=useNavigate();// Load cart data from localStorage on component mount\n// Load cart data from localStorage on component mount\nuseEffect(()=>{const storedCart=JSON.parse(localStorage.getItem('cart'))||[];dispatch({type:'SET_CART',payload:storedCart});},[dispatch]);// Update localStorage whenever cart changes\nuseEffect(()=>{localStorage.setItem('cart',JSON.stringify(cart));},[cart]);// Update total price when cart changes\nuseEffect(()=>{let totalPrice=0;if(cart){totalPrice=cart.reduce((acc,item)=>{const itemPrice=item.option?item.option.price:item.price;// Consider option price if it exists\nreturn acc+itemPrice*item.quantity;},0);}setTotalPrice(totalPrice);},[cart]);const handleRemoveItem=index=>{dispatch({type:'REMOVE_FROM_CART',payload:index});};const handleCheckout=async()=>{try{if(!userEmail||!Name){console.error('User email or name not found in localStorage');return;}const response=await axios.post('/orders',{email:userEmail,cartItems:cart,Name:Name});console.log('Checkout response:',response.data);dispatch({type:'CLEAR_CART'});alert('Checkout successful!');// Redirect to myorders page after successful checkout\nnavigate('/orders');}catch(error){console.error('Checkout error:',error.message);alert('Checkout failed. Please try again later.');}};return/*#__PURE__*/_jsxs(\"div\",{className:\"cart-container\",children:[/*#__PURE__*/_jsx(\"h1\",{children:\"Cart\"}),/*#__PURE__*/_jsxs(Table,{striped:true,bordered:true,hover:true,children:[/*#__PURE__*/_jsx(\"thead\",{children:/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"th\",{children:\"Name\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Price\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Quantity\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Actions\"})]})}),/*#__PURE__*/_jsx(\"tbody\",{children:cart&&cart.map((item,index)=>/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsxs(\"td\",{children:[item.name,\" \",item.option&&\"(\".concat(item.option.name,\")\")]}),/*#__PURE__*/_jsxs(\"td\",{children:[\"$\",item.option?item.option.price:item.price]}),/*#__PURE__*/_jsx(\"td\",{children:item.quantity}),/*#__PURE__*/_jsx(\"td\",{children:/*#__PURE__*/_jsx(Button,{variant:\"danger\",onClick:()=>handleRemoveItem(index),style:{\"backgroundColor\":\"red\"},children:\"Remove\"})})]},index))})]}),cart.length>0?/*#__PURE__*/_jsxs(\"div\",{className:\"checkout-container\",children:[/*#__PURE__*/_jsxs(\"h2\",{children:[\"Total Price: $\",totalPrice]}),/*#__PURE__*/_jsx(Button,{variant:\"primary\",onClick:handleCheckout,style:{\"backgroundColor\":\"blue\"},children:\"Checkout\"})]}):/*#__PURE__*/_jsxs(\"div\",{className:\"empty-cart-container\",children:[/*#__PURE__*/_jsx(\"h2\",{children:\"Your cart is empty\"}),/*#__PURE__*/_jsx(Button,{variant:\"info\",onClick:()=>navigate('/'),style:{\"backgroundColor\":\"blue\"},children:\"Back to Home\"})]})]});}","map":{"version":3,"names":["React","useEffect","useState","Table","Button","axios","useCart","useDispatchCart","useNavigate","Link","jsx","_jsx","jsxs","_jsxs","Cart","cart","dispatch","totalPrice","setTotalPrice","userEmail","localStorage","getItem","Name","navigate","storedCart","JSON","parse","type","payload","setItem","stringify","reduce","acc","item","itemPrice","option","price","quantity","handleRemoveItem","index","handleCheckout","console","error","response","post","email","cartItems","log","data","alert","message","className","children","striped","bordered","hover","map","name","concat","variant","onClick","style","length"],"sources":["C:/mern stack-project/Food ordering/backend/frontend/src/components/Cart.js"],"sourcesContent":["// Cart.js\r\nimport React, { useEffect, useState } from 'react';\r\nimport { Table, Button } from 'react-bootstrap';\r\nimport axios from 'axios';\r\nimport { useCart, useDispatchCart } from './Contextreducer';\r\nimport { useNavigate,Link } from 'react-router-dom';\r\n\r\nexport default function Cart() {\r\n  const cart = useCart();\r\n  const dispatch = useDispatchCart();\r\n  const [totalPrice, setTotalPrice] = useState(0);\r\n  const userEmail = localStorage.getItem('userEmail');\r\n  const Name = localStorage.getItem('Name');\r\n  const navigate = useNavigate();\r\n\r\n  // Load cart data from localStorage on component mount\r\n  // Load cart data from localStorage on component mount\r\nuseEffect(() => {\r\n  const storedCart = JSON.parse(localStorage.getItem('cart')) || [];\r\n  dispatch({ type: 'SET_CART', payload: storedCart });\r\n}, [dispatch]);\r\n\r\n// Update localStorage whenever cart changes\r\nuseEffect(() => {\r\n  localStorage.setItem('cart', JSON.stringify(cart));\r\n}, [cart]);\r\n\r\n  \r\n\r\n  // Update total price when cart changes\r\n  useEffect(() => {\r\n    let totalPrice = 0;\r\n    if (cart) {\r\n      totalPrice = cart.reduce((acc, item) => {\r\n        const itemPrice = item.option ? item.option.price : item.price; // Consider option price if it exists\r\n        return acc + itemPrice * item.quantity;\r\n      }, 0);\r\n    }\r\n    setTotalPrice(totalPrice);\r\n  }, [cart]);\r\n\r\n  \r\n  const handleRemoveItem = (index) => {\r\n    dispatch({ type: 'REMOVE_FROM_CART', payload: index });\r\n  };\r\n\r\n  const handleCheckout = async () => {\r\n    try {\r\n      if (!userEmail || !Name) {\r\n        console.error('User email or name not found in localStorage');\r\n        return;\r\n      }\r\n      const response = await axios.post('/orders', { email: userEmail, cartItems: cart, Name: Name });\r\n      console.log('Checkout response:', response.data);\r\n      dispatch({ type: 'CLEAR_CART' });\r\n      alert('Checkout successful!');\r\n      // Redirect to myorders page after successful checkout\r\n      navigate('/orders');\r\n    } catch (error) {\r\n      console.error('Checkout error:', error.message);\r\n      alert('Checkout failed. Please try again later.');\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div className=\"cart-container\">\r\n      <h1>Cart</h1>\r\n      <Table striped bordered hover>\r\n        <thead>\r\n          <tr>\r\n            <th>Name</th>\r\n            <th>Price</th>\r\n            <th>Quantity</th>\r\n            <th>Actions</th>\r\n          </tr>\r\n        </thead>\r\n        <tbody>\r\n          {cart && cart.map((item, index) => (\r\n            <tr key={index}>\r\n              <td>{item.name} {item.option && `(${item.option.name})`}</td>\r\n              <td>${item.option ? item.option.price : item.price}</td>\r\n              <td>{item.quantity}</td>\r\n              <td>\r\n                <Button variant=\"danger\" onClick={() => handleRemoveItem(index)} style={{\"backgroundColor\":\"red\"}}>Remove</Button>\r\n              </td>\r\n            </tr>\r\n          ))}\r\n        </tbody>\r\n      </Table>\r\n      {cart.length > 0 ? (\r\n        <div className=\"checkout-container\">\r\n          <h2>Total Price: ${totalPrice}</h2>\r\n          <Button variant=\"primary\" onClick={handleCheckout} style={{\"backgroundColor\":\"blue\"}}>Checkout</Button>\r\n        </div>\r\n      ) : (\r\n        <div className=\"empty-cart-container\">\r\n          <h2>Your cart is empty</h2>\r\n          <Button variant=\"info\" onClick={() => navigate('/')}  style={{\"backgroundColor\":\"blue\"}} >Back to Home</Button>\r\n        </div>\r\n      )}\r\n      \r\n\r\n    </div>\r\n     \r\n  );\r\n}"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}